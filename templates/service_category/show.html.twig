{% extends 'base.html.twig' %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('styles/service_category/styles.css') }}">
{% endblock %}

{% block body %}
    <div class="container mt-4 mb-5">
        <div class="category-header">
            <h4>{{ category.name }}</h4>
        </div>

        {# Sekcja filtrów #}
        <div class="filters-section">
            <button class="filter-toggle" data-bs-toggle="collapse" data-bs-target="#filterCollapse">
                <i class="fas fa-sliders-h filter-icon"></i> Filtry
            </button>

            <div class="collapse {{ searchTerm ? 'show' }}" id="filterCollapse">
                <form class="mt-3">
                    <div class="search-container">
                        <i class="fas fa-search search-icon"></i>
                        <input
                                type="text"
                                class="search-input"
                                name="searchTerm"
                                value="{{ searchTerm }}"
                                placeholder="Szukaj usług lub biznesów"
                        >
                        <button type="submit" class="search-button">
                            Szukaj
                        </button>
                    </div>
                </form>
            </div>
        </div>

        {# Lista usług #}
        {% if category.services|length > 0 %}
            <div class="services-grid">
                {% for service in category.services %}
                    <div class="service-card">
                        <div class="service-rating">
                            <i class="fas fa-star" style="color: #333;"></i>
                            <span class="rating-score">{{ service.averageRating|number_format(1) }}</span>
                            <span class="rating-count">({{ service.opinionsCount }})</span>
                        </div>

                        <div class="service-image-container">
                            <img
                                    src="{{ service.imageUrl }}"
                                    class="service-image"
                                    alt="{{ service.name }}"
                                    onerror="this.src='https://fastly.picsum.photos/id/40/640/480.jpg?hmac=g_iGJ4xMON_SqGk0lEb_9nIhJG1-H783dsL3S5QQw2g'"
                            >
                        </div>

                        <div class="card-body">
                            <h5 class="service-title">{{ service.name }}</h5>

                            <div class="service-info">
                                <i class="fas fa-map-marker-alt info-icon"></i>
                                <span>{{ service.street }}, {{ service.postalCode }}, {{ service.city }}</span>
                            </div>

                            <div class="service-info">
                                <i class="fas fa-phone info-icon"></i>
                                <span>{{ service.phoneNumber }}</span>
                            </div>

                            <a href="{{ path('service_show', {'encodedName': service.encodedName}) }}" class="btn more-btn">
                                Więcej <i class="fas fa-arrow-right btn-icon"></i>
                            </a>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="empty-results">
                <div class="empty-icon">
                    <i class="fas fa-search"></i>
                </div>
                <p class="empty-text">Nie znaleziono żadnych serwisów dla tej kategorii.</p>
            </div>
        {% endif %}
    </div>

    {% block javascripts %}
        {{ parent() }}
        <script src="{{ asset('js/service_category/show.js') }}"></script>
    {% endblock %}
{% endblock %}